var U=Object.defineProperty;var z=(r,e,i)=>e in r?U(r,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[e]=i;var A=(r,e,i)=>(z(r,typeof e!="symbol"?e+"":e,i),i),W=(r,e,i)=>{if(!e.has(r))throw TypeError("Cannot "+i)};var t=(r,e,i)=>(W(r,e,"read from private field"),i?i.call(r):e.get(r)),l=(r,e,i)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,i)},h=(r,e,i,n)=>(W(r,e,"write to private field"),n?n.call(r,i):e.set(r,i),i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const g of a.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&n(g)}).observe(document,{childList:!0,subtree:!0});function i(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=i(s);fetch(s.href,a)}})();const c=r=>document.querySelectorAll(r);var E=(r=>(r[r.play=0]="play",r[r.arrange=1]="arrange",r))(E||{}),d=(r=>(r.blue="blue",r.red="red",r))(d||{});const H=""+new URL("../images/red-tank.svg",import.meta.url).href,x=""+new URL("../images/blue-tank.svg",import.meta.url).href,F=""+new URL("../images/dead.svg",import.meta.url).href;var k,f,p;class I{constructor(e=""){l(this,k,!1);l(this,f,new Image);l(this,p,void 0);A(this,"destroy",()=>{t(this,f).src=F,h(this,k,!0)});h(this,p,e),t(this,f).classList.add("tank"),t(this,p)==="red"&&(t(this,f).src=H),t(this,p)==="blue"&&(t(this,f).src=x)}get position(){var e;return(e=t(this,f).parentElement)==null?void 0:e.getAttribute("data-address")}get isDead(){return t(this,k)}get cell(){return t(this,f)}get color(){return t(this,p)}}k=new WeakMap,f=new WeakMap,p=new WeakMap;var $,G,u,C;class q{constructor(e,i="Ù¾ÛŒØ§Ù… ØªØ³Øª",n=3e3){l(this,$,void 0);l(this,G,void 0);l(this,u,void 0);l(this,C,void 0);h(this,$,n),h(this,G,i),h(this,u,document.createElement("DIV")),t(this,u).classList.add("toast"),h(this,C,e),t(this,u).innerText=t(this,G),t(this,u).classList.add(t(this,C))}show(){document.body.append(t(this,u)),t(this,u).classList.add("show"),setTimeout(()=>t(this,u).remove(),t(this,$))}}$=new WeakMap,G=new WeakMap,u=new WeakMap,C=new WeakMap;var o,y,b,v,L,m,w;class K{constructor(e,i=4){l(this,o,{blue:{},red:{}});l(this,y,void 0);l(this,b,4);l(this,v,d.red);l(this,L,E.arrange);l(this,m,{red:0,blue:0});l(this,w,null);A(this,"handleGridClick",e=>{const n=e.target.tagName==="IMG"?e.target.parentElement:e.target,s=n.dataset.address,a=n.parentElement.id;if(console.log({alive:t(this,m),state:t(this,o),winner:t(this,w),mode:t(this,L)}),t(this,L)===E.play){const g=a==="blue"?"red":"blue",O=t(this,o)[g][s];O instanceof I&&O.destroy();const P={blue:0,red:0};["blue","red"].forEach(T=>{for(const R in t(this,o)[T]){const D=t(this,o)[T][R];D instanceof I&&!D.isDead&&P[T]++,t(this,m)[T]=P[T]}}),console.log(`${a}:alive: ${t(this,m)[a]}`);const S=this.whoWon();S?(h(this,w,S),this.showWinner()):this.changePlayer()}t(this,L)===E.arrange&&this.addTank(s,new I(a))});A(this,"changePlayer",()=>{h(this,v,t(this,v)===d.blue?d.red:d.blue),t(this,y).classList.toggle("blue"),t(this,v)===d.red&&(document.querySelector(".color-indicator").className=`color-indicator ${d.red}`),t(this,v)===d.blue&&(document.querySelector(".color-indicator").className=`color-indicator ${d.blue}`)});h(this,y,e),h(this,b,i),this.generateGrid(),this.renderGame()}generateGrid(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZ";["blue","red"].forEach(i=>{for(let n=0;n<t(this,b);n++)for(let s=0;s<t(this,b);s++)t(this,o)[i][`${e[n]}${s+1}`]={}})}renderGame(){t(this,y).innerHTML="",this.renderGrid("blue",t(this,o).blue),this.renderGrid("red",t(this,o).red),c(".grid").forEach(e=>e.addEventListener("click",this.handleGridClick))}renderGrid(e,i){let n=`<div class="grid" id="${e}">
`;for(const s in i)n+=`	<div class="grid__cell" data-address="${s}"></div>
`;n+="</div>",t(this,y).innerHTML+=n,c(".grid").forEach(s=>{s.style.gridTemplateColumns=`repeat(${t(this,b)}, 1fr)`,s.style.gridTemplateRows=`repeat(${t(this,b)}, 1fr)`})}whoWon(){return t(this,m).red===0?d.blue:t(this,m).blue===0?d.red:null}showWinner(){t(this,w)===d.blue&&new q(d.blue,"Ø¢Ø¨ÛŒ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯!").show(),t(this,w)===d.red&&new q(d.red,"Ù‚Ø±Ù…Ø² Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯!").show(),this.freeze()}freeze(){c(".btn:not(#btn-reload)").forEach(e=>e.disabled=!0),c(".grid").forEach(e=>e.removeEventListener("click",this.handleGridClick))}addTank(e,i){const n={blue:0,red:0};["blue","red"].forEach(s=>{for(const a in t(this,o)[s]){const g=t(this,o)[s][a];g instanceof I&&!g.isDead&&n[s]++,t(this,m)[s]=n[s]}}),t(this,o)[i.color][e]=i,c(`#${i.color}`)[0].querySelector(`[data-address=${e}]`).append(i.cell)}set mode(e){h(this,L,e)}}o=new WeakMap,y=new WeakMap,b=new WeakMap,v=new WeakMap,L=new WeakMap,m=new WeakMap,w=new WeakMap;const N=new K(c("#ðŸŽ®")[0],2);c("#start-btn")[0].addEventListener("click",()=>{c("#ðŸ‘ž")[0].classList.add("hidden"),c("#note")[0].remove()});c("#btn-arrange-tanks")[0].addEventListener("click",()=>N.mode=E.arrange);c("#btn-play-game")[0].addEventListener("click",()=>N.mode=E.play);c("#btn-change-player")[0].addEventListener("click",N.changePlayer);c("#btn-reload")[0].addEventListener("click",()=>window.location.reload());
